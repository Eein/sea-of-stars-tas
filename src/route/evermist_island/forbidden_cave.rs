use crate::seq::movement::*;
use crate::state::{GameEvent, GameState};
use seq::prelude::*;

pub fn create() -> Box<dyn Node<GameState, GameEvent>> {
    SeqList::create(
        "Forbidden Cave",
        vec![
            SeqMove::create(
                "Caverns",
                vec![
                    Move::To(14.000, 1.002, 14.367),
                    Move::To(14.000, 1.002, 17.396),
                    Move::Confirm, // Open door to cave
                    Move::To(14.000, 1.002, 17.396),
                    Move::HoldDir([0.0, 1.0], [14.050, -0.998, 69.499]),
                    Move::To(14.050, -0.998, 120.905),
                    Move::To(6.759, -0.998, 128.605),
                    Move::HoldDir([-1.0, 1.0], [-25.425, 5.002, 128.568]),
                    Move::To(-28.461, 5.002, 130.157),
                    Move::Interact(-46.540, 5.002, 130.157),
                    Move::To(-54.723, 5.002, 132.877),
                    Move::To(-56.857, 5.002, 135.580),
                    Move::To(-56.857, 5.002, 137.540),
                    // TODO(orkaboy): Double back to fight (not optimal)
                    Move::To(-56.857, 5.002, 135.580),
                    Move::To(-56.857, 5.002, 137.540),
                    // Climb wall
                    Move::Climb(-56.857, 15.002, 138.467),
                    Move::To(-54.918, 15.002, 140.050),
                    Move::Interact(-51.500, 15.002, 140.050),
                    Move::To(-49.459, 7.002, 139.459),
                    Move::Log("Wait for lock"),
                    Move::WaitFor(0.2),
                    Move::Interact(-45.533, 9.002, 139.460),
                    Move::Interact(-45.533, 15.002, 141.467),
                    Move::To(-43.460, 15.002, 141.546),
                    Move::Climb(-43.460, 16.540, 141.540),
                    Move::Climb(-35.176, 16.540, 141.530),
                    Move::Climb(-35.176, 11.002, 141.540),
                    Move::To(-33.449, 11.002, 139.844),
                    Move::To(-25.329, 11.002, 139.354),
                    Move::To(-22.536, 11.002, 136.561),
                    Move::HoldDir([1.0, -1.0], [5.170, 5.002, 132.895]),
                    Move::To(8.542, 5.002, 136.778),
                    Move::To(11.492, 5.002, 139.500),
                    Move::HoldDir([1.0, 1.0], [13.000, 5.002, 139.500]),
                    Move::To(16.550, 5.002, 139.500),
                    Move::To(19.659, 5.002, 137.594),
                    Move::To(21.075, 5.002, 138.526),
                    Move::HoldDir([1.0, 1.0], [53.465, 1.002, 127.634]),
                    Move::Log("Navigate to platform"),
                    Move::To(59.844, 1.002, 132.896),
                    Move::To(57.981, 1.018, 139.464),
                    Move::Interact(56.926, 4.012, 140.576),
                    Move::Interact(59.915, 8.012, 144.015),
                    Move::To(60.501, 8.002, 148.204),
                    Move::To(71.706, 10.002, 148.204),
                    Move::To(73.633, 10.002, 142.899),
                    Move::To(72.258, 10.002, 138.201),
                    Move::Interact(69.421, 5.002, 138.381),
                    Move::To(69.421, 3.002, 138.381),
                    Move::Log("Wait for lock"),
                    Move::WaitFor(0.2),
                    Move::Interact(61.050, 1.002, 138.381),
                    Move::To(59.146, 1.002, 138.458),
                    Move::Interact(56.907, 7.002, 140.756),
                    Move::Interact(58.112, 10.002, 142.334),
                    Move::Interact(55.871, 16.002, 144.339),
                    Move::To(54.157, 16.002, 144.114),
                    Move::Log("Forbidden Cavern Key"),
                    Move::Confirm,
                    Move::Interact(61.458, 1.002, 144.189),
                    Move::Log("Approach lever"),
                    Move::To(62.844, 1.002, 144.645),
                    Move::Log("Pull lever"),
                    Move::Confirm,
                    Move::To(61.161, 1.002, 140.211),
                    Move::To(58.021, 1.012, 140.371),
                    Move::Interact(56.973, 4.012, 141.322),
                    Move::Interact(57.899, 7.012, 142.221),
                    Move::Interact(56.773, 10.012, 143.094),
                    Move::To(55.502, 10.012, 141.361),
                    Move::To(54.687, 10.012, 141.060),
                    Move::Log("Open lock"),
                    Move::Confirm,
                    Move::HoldDir([-1.0, 1.0], [72.100, 6.002, 203.000]),
                    Move::To(69.064, 6.002, 205.976),
                    Move::Log("Picnic basket"),
                    Move::Confirm,
                    Move::To(66.875, 6.002, 205.755),
                    Move::To(64.141, 6.002, 208.489),
                    Move::To(63.918, 6.002, 209.744),
                    Move::Log("Mending Light"),
                    Move::Confirm,
                    Move::To(62.138, 6.002, 210.357),
                    Move::Log("Shiny Pearl"),
                    Move::Confirm,
                    Move::To(63.039, 6.002, 207.960),
                    Move::To(60.519, 6.002, 206.460),
                    Move::To(53.945, 6.002, 203.097),
                    Move::HoldDir([-1.0, -1.0], [19.085, 13.002, 136.585]),
                    Move::To(16.958, 13.002, 138.682),
                    Move::Climb(16.958, 20.143, 140.530),
                    Move::Climb(19.374, 20.143, 140.530),
                    Move::To(21.487, 20.002, 137.556),
                    Move::To(22.693, 20.002, 136.291),
                    // TODO: Optionally, get Leeching Thorn
                    Move::To(25.451, 20.002, 133.119),
                    Move::To(25.335, 20.002, 132.576),
                    Move::Interact(25.335, 1.010, 130.365),
                    Move::Log("Wait for lock"),
                    Move::WaitFor(0.2),
                    Move::Interact(25.335, -0.990, 125.800),
                    Move::To(20.202, -0.998, 124.117),
                    Move::To(15.461, -0.998, 134.781),
                    Move::To(14.093, -0.998, 139.361),
                    Move::HoldDir([0.0, 1.0], [13.931, 5.002, 181.026]),
                    Move::AwaitCutscene(Box::new(Move::HoldDir([0.0, 1.0], [0.0, 0.0, 0.0]))),
                    Move::To(12.471, 5.002, 200.353),
                    Move::Interact(6.260, 5.002, 200.353),
                    Move::To(4.604, 5.002, 203.368),
                    Move::To(4.602, 5.000, 204.832),
                    Move::HoldDir([-1.0, 1.0], [-30.917, 2.002, 203.683]),
                    Move::To(-39.117, 2.002, 201.905),
                    Move::Log("Campfire"),
                    Move::Confirm,
                ],
            ),
            SeqCheckpoint::create("forbidden_cave2"),
            // Continue to boss
            SeqMove::create(
                "Boss",
                vec![
                    Move::Log("Approach"),
                    Move::To(-39.370, 2.002, 206.332),
                    Move::To(-39.370, 2.002, 219.607),
                    Move::AwaitCombat(Box::new(Move::HoldDir([0.0, 1.0], [0.0, 0.0, 0.0]))),
                    // TODO: Optionally, can enter cave to the north here and grab items
                    Move::To(-35.969, 2.002, 236.869),
                    Move::Interact(-32.475, 6.002, 237.234),
                    Move::To(-31.291, 6.002, 237.234),
                    Move::HoldDir([1.0, 1.0], [5.796, 11.002, 244.657]),
                    Move::To(8.675, 11.002, 243.322),
                    Move::Interact(12.419, 5.002, 243.322),
                    Move::To(14.032, 5.002, 250.628),
                    Move::Log("Leave cavern"),
                    Move::AwaitCutscene(Box::new(Move::HoldDir([0.0, 1.0], [0.0, 0.0, 0.0]))),
                ],
            ),
        ],
    )
}
